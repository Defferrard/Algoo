368a60a67069b335d73a4f5fe0187477
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const dto_1 = require("@defferrard/algoo-core/src/dto");
const class_transformer_validator_1 = require("class-transformer-validator");
const http_status_1 = __importDefault(require("http-status"));
const routing_controllers_1 = require("routing-controllers");
const supertest_1 = __importDefault(require("supertest"));
const typedi_1 = require("typedi");
const app_1 = require("~/app");
const BASE_URL = '/api/v1/auth';
describe(`Base Test ${BASE_URL}`, () => {
    beforeAll(() => {
        (0, routing_controllers_1.useContainer)(typedi_1.Container);
    });
    afterEach(() => {
        typedi_1.Container.reset();
    });
    test('Authenticate', async () => {
        await (0, supertest_1.default)(app_1.app).get(`${BASE_URL}/current`).expect(http_status_1.default.UNAUTHORIZED);
        const response = await (0, supertest_1.default)(app_1.app).post(`${BASE_URL}/`).send({
            name: 'test',
        });
        expect(response.status).toBe(http_status_1.default.OK);
        await (0, class_transformer_validator_1.transformAndValidate)(dto_1.JwtDTO, response.body);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXEdpdGh1YlxcQWxnb29cXGJhY2tlbmRcXHNyY1xcY29udHJvbGxlcnNcXGF1dGgudGVzdC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLHdEQUF3RDtBQUN4RCw2RUFBbUU7QUFDbkUsOERBQWlDO0FBQ2pDLDZEQUFtRDtBQUNuRCwwREFBZ0M7QUFDaEMsbUNBQW1DO0FBQ25DLCtCQUE0QjtBQUU1QixNQUFNLFFBQVEsR0FBVyxjQUFjLENBQUM7QUFDeEMsUUFBUSxDQUFDLGFBQWEsUUFBUSxFQUFFLEVBQUUsR0FBRyxFQUFFO0lBQ3JDLFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixJQUFBLGtDQUFZLEVBQUMsa0JBQVMsQ0FBQyxDQUFDO0lBQzFCLENBQUMsQ0FBQyxDQUFDO0lBQ0gsU0FBUyxDQUFDLEdBQUcsRUFBRTtRQUNiLGtCQUFTLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDcEIsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsY0FBYyxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzlCLE1BQU0sSUFBQSxtQkFBTyxFQUFDLFNBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLFFBQVEsVUFBVSxDQUFDLENBQUMsTUFBTSxDQUFDLHFCQUFNLENBQUMsWUFBWSxDQUFDLENBQUM7UUFFMUUsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFBLG1CQUFPLEVBQUMsU0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsUUFBUSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7WUFDNUQsSUFBSSxFQUFFLE1BQU07U0FDYixDQUFDLENBQUM7UUFDSCxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3hDLE1BQU0sSUFBQSxrREFBb0IsRUFBQyxZQUFNLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BELENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXEdpdGh1YlxcQWxnb29cXGJhY2tlbmRcXHNyY1xcY29udHJvbGxlcnNcXGF1dGgudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBKd3REVE8gfSBmcm9tICdAZGVmZmVycmFyZC9hbGdvby1jb3JlL3NyYy9kdG8nO1xuaW1wb3J0IHsgdHJhbnNmb3JtQW5kVmFsaWRhdGUgfSBmcm9tICdjbGFzcy10cmFuc2Zvcm1lci12YWxpZGF0b3InO1xuaW1wb3J0IFN0YXR1cyBmcm9tICdodHRwLXN0YXR1cyc7XG5pbXBvcnQgeyB1c2VDb250YWluZXIgfSBmcm9tICdyb3V0aW5nLWNvbnRyb2xsZXJzJztcbmltcG9ydCByZXF1ZXN0IGZyb20gJ3N1cGVydGVzdCc7XG5pbXBvcnQgeyBDb250YWluZXIgfSBmcm9tICd0eXBlZGknO1xuaW1wb3J0IHsgYXBwIH0gZnJvbSAnfi9hcHAnO1xuXG5jb25zdCBCQVNFX1VSTDogc3RyaW5nID0gJy9hcGkvdjEvYXV0aCc7XG5kZXNjcmliZShgQmFzZSBUZXN0ICR7QkFTRV9VUkx9YCwgKCkgPT4ge1xuICBiZWZvcmVBbGwoKCkgPT4ge1xuICAgIHVzZUNvbnRhaW5lcihDb250YWluZXIpO1xuICB9KTtcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBDb250YWluZXIucmVzZXQoKTtcbiAgfSk7XG5cbiAgdGVzdCgnQXV0aGVudGljYXRlJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHJlcXVlc3QoYXBwKS5nZXQoYCR7QkFTRV9VUkx9L2N1cnJlbnRgKS5leHBlY3QoU3RhdHVzLlVOQVVUSE9SSVpFRCk7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKS5wb3N0KGAke0JBU0VfVVJMfS9gKS5zZW5kKHtcbiAgICAgIG5hbWU6ICd0ZXN0JyxcbiAgICB9KTtcbiAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKFN0YXR1cy5PSyk7XG4gICAgYXdhaXQgdHJhbnNmb3JtQW5kVmFsaWRhdGUoSnd0RFRPLCByZXNwb25zZS5ib2R5KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==