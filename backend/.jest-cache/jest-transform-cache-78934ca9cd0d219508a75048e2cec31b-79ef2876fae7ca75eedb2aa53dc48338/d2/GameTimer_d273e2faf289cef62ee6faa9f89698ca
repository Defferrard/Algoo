f40d293a9145a15e5bb7b28f732b7bd3
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class GameTimer {
    turnTime;
    intervalTime;
    _last;
    _next;
    _interval;
    _callback;
    constructor() {
        this._last = Date.now();
        this._next = this._last;
        this.turnTime = 20000;
        this.intervalTime = 100;
    }
    start(callback) {
        if (this._interval)
            clearInterval(this._interval);
        this._callback = callback;
        this._last = Date.now();
        this._next = this._last + this.turnTime;
        this._interval = setInterval(this.getTick(), this.intervalTime);
    }
    stop() {
        clearInterval(this._interval);
        this._interval = undefined;
        this._callback = undefined;
    }
    restart(callback) {
        this.stop();
        this.start(callback);
    }
    get last() {
        return this._last;
    }
    get next() {
        return this._next;
    }
    onTick(now) {
        if (now > this._next) {
            this._callback();
            clearInterval(this._interval);
        }
    }
    getTick() {
        return () => {
            this.onTick(Date.now());
        };
    }
}
exports.default = GameTimer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXEdpdGh1YlxcQWxnb29cXGNvcmVcXHNyY1xcZ2FtZVxcR2FtZVRpbWVyLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsTUFBcUIsU0FBUztJQUM1QixRQUFRLENBQVM7SUFDakIsWUFBWSxDQUFTO0lBQ2IsS0FBSyxDQUFTO0lBQ2QsS0FBSyxDQUFTO0lBRWQsU0FBUyxDQUFNO0lBQ2YsU0FBUyxDQUFjO0lBRS9CO1FBQ0UsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDeEIsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ3hCLElBQUksQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFDO1FBQ3RCLElBQUksQ0FBQyxZQUFZLEdBQUcsR0FBRyxDQUFDO0lBQzFCLENBQUM7SUFFRCxLQUFLLENBQUMsUUFBb0I7UUFDeEIsSUFBSSxJQUFJLENBQUMsU0FBUztZQUFFLGFBQWEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDbEQsSUFBSSxDQUFDLFNBQVMsR0FBRyxRQUFRLENBQUM7UUFDMUIsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDeEIsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7UUFDeEMsSUFBSSxDQUFDLFNBQVMsR0FBRyxXQUFXLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUNsRSxDQUFDO0lBRUQsSUFBSTtRQUNGLGFBQWEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDOUIsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFDM0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7SUFDN0IsQ0FBQztJQUVELE9BQU8sQ0FBQyxRQUFvQjtRQUMxQixJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDWixJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3ZCLENBQUM7SUFFRCxJQUFjLElBQUk7UUFDaEIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQ3BCLENBQUM7SUFFRCxJQUFjLElBQUk7UUFDaEIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQ3BCLENBQUM7SUFFUyxNQUFNLENBQUMsR0FBVztRQUMxQixJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDckIsSUFBSSxDQUFDLFNBQVUsRUFBRSxDQUFDO1lBQ2xCLGFBQWEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDaEMsQ0FBQztJQUNILENBQUM7SUFFTyxPQUFPO1FBQ2IsT0FBTyxHQUFHLEVBQUU7WUFDVixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQzFCLENBQUMsQ0FBQztJQUNKLENBQUM7Q0FDRjtBQXZERCw0QkF1REMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXEdpdGh1YlxcQWxnb29cXGNvcmVcXHNyY1xcZ2FtZVxcR2FtZVRpbWVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVUaW1lciB7XG4gIHR1cm5UaW1lOiBudW1iZXI7XG4gIGludGVydmFsVGltZTogbnVtYmVyO1xuICBwcml2YXRlIF9sYXN0OiBudW1iZXI7XG4gIHByaXZhdGUgX25leHQ6IG51bWJlcjtcblxuICBwcml2YXRlIF9pbnRlcnZhbDogYW55O1xuICBwcml2YXRlIF9jYWxsYmFjaz86ICgpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5fbGFzdCA9IERhdGUubm93KCk7XG4gICAgdGhpcy5fbmV4dCA9IHRoaXMuX2xhc3Q7XG4gICAgdGhpcy50dXJuVGltZSA9IDIwMDAwO1xuICAgIHRoaXMuaW50ZXJ2YWxUaW1lID0gMTAwO1xuICB9XG5cbiAgc3RhcnQoY2FsbGJhY2s6ICgpID0+IHZvaWQpIHtcbiAgICBpZiAodGhpcy5faW50ZXJ2YWwpIGNsZWFySW50ZXJ2YWwodGhpcy5faW50ZXJ2YWwpO1xuICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgdGhpcy5fbGFzdCA9IERhdGUubm93KCk7XG4gICAgdGhpcy5fbmV4dCA9IHRoaXMuX2xhc3QgKyB0aGlzLnR1cm5UaW1lO1xuICAgIHRoaXMuX2ludGVydmFsID0gc2V0SW50ZXJ2YWwodGhpcy5nZXRUaWNrKCksIHRoaXMuaW50ZXJ2YWxUaW1lKTtcbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLl9pbnRlcnZhbCk7XG4gICAgdGhpcy5faW50ZXJ2YWwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fY2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gIH1cblxuICByZXN0YXJ0KGNhbGxiYWNrOiAoKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5zdG9wKCk7XG4gICAgdGhpcy5zdGFydChjYWxsYmFjayk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0IGxhc3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xhc3Q7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0IG5leHQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX25leHQ7XG4gIH1cblxuICBwcm90ZWN0ZWQgb25UaWNrKG5vdzogbnVtYmVyKSB7XG4gICAgaWYgKG5vdyA+IHRoaXMuX25leHQpIHtcbiAgICAgIHRoaXMuX2NhbGxiYWNrISgpO1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLl9pbnRlcnZhbCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRUaWNrKCkge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB0aGlzLm9uVGljayhEYXRlLm5vdygpKTtcbiAgICB9O1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=